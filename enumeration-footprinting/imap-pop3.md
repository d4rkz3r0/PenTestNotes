---
description: IMAP - TCP 143/993
---

# IMAP/POP3

## IMAP Server Commands

| Command                         | Description                                                                                                   |
| ------------------------------- | ------------------------------------------------------------------------------------------------------------- |
| `1 LOGIN username password`     | User's login.                                                                                                 |
| `1 LIST "" *`                   | Lists all directories.                                                                                        |
| `1 CREATE "INBOX"`              | Creates a mailbox with a specified name.                                                                      |
| `1 DELETE "INBOX"`              | Deletes a mailbox.                                                                                            |
| `1 RENAME "ToRead" "Important"` | Renames a mailbox.                                                                                            |
| `1 LSUB "" *`                   | Returns a subset of names from the set of names that the User has declared as being `active` or `subscribed`. |
| `1 SELECT INBOX`                | Selects a mailbox so that messages in the mailbox can be accessed.                                            |
| `1 UNSELECT INBOX`              | Exits the selected mailbox.                                                                                   |
| `1 FETCH <MESSAGE_ID> all`      | Retrieves metadata associated with a message in the mailbox.                                                  |
| `1 FETCH <MESSAGE_ID> RFC822`   | Retrieves content associated with a  message in the mailbox.                                                  |
| `1 CLOSE`                       | Removes all messages with the `Deleted` flag set.                                                             |
| `1 LOGOUT`                      | Closes the connection with the IMAP server.                                                                   |

***

## POP3 Server Commands

#### TCP 110/995

| Command         | Description                                                 |
| --------------- | ----------------------------------------------------------- |
| `USER username` | Identifies the user.                                        |
| `PASS password` | Authentication of the user using its password.              |
| `STAT`          | Requests the number of saved emails from the server.        |
| `LIST`          | Requests from the server the number and size of all emails. |
| `RETR id`       | Requests the server to deliver the requested email by ID.   |
| `DELE id`       | Requests the server to delete the requested email by ID.    |
| `CAPA`          | Requests the server to display the server capabilities.     |
| `RSET`          | Requests the server to reset the transmitted information.   |
| `QUIT`          | Closes the connection with the POP3 server.                 |

***

## NMAP

{% code title="Default Script Scan" %}
```sh
sudo nmap TARGET_IP -sV -p110,143,993,995 -sC
```
{% endcode %}

***

## CURL

{% code title="Authenticated Banner Grab" %}
```sh
curl -k 'imap/imaps/pop3/pop3s://TARGET_IP' --user username:password -v
```
{% endcode %}

\-k - accepts insecure connections resulting from things such as self-signed certificates

***

## OpenSSL

{% code title="Connection Secure" %}
```sh
openssl s_client -connect TARGET_IP:imaps/pop3s
```
{% endcode %}
